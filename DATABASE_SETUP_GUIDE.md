# OpenEMR Database Setup Guide

## Current Status
✅ **PHP Extensions**: All required extensions are now enabled  
❌ **MySQL Database**: Not installed or not running  

## Issue Summary
OpenEMR requires a MySQL or MariaDB database server, but none is currently running on your system. The connection test shows "connection refused" which means no database server is listening on port 3306.

## Solution Options

### Option 1: Install XAMPP (Recommended for Development)
XAMPP includes Apache, MySQL, and PHP in one package:

1. **Download XAMPP:**
   - Visit: https://www.apachefriends.org/
   - Download the Windows version with PHP 8.2

2. **Install XAMPP:**
   - Run the installer as Administrator
   - Select Apache, MySQL, and phpMyAdmin components
   - Install to default location (C:\xampp)

3. **Start Services:**
   - Open XAMPP Control Panel
   - Click "Start" for Apache and MySQL
   - MySQL should show "Running" on port 3306

4. **Create OpenEMR Database:**
   ```sql
   -- Access phpMyAdmin (http://localhost/phpmyadmin)
   -- Or use mysql command line
   CREATE DATABASE openemr;
   CREATE USER 'admin'@'localhost' IDENTIFIED BY 'Badger1234!';
   GRANT ALL PRIVILEGES ON openemr.* TO 'admin'@'localhost';
   FLUSH PRIVILEGES;
   ```

### Option 2: Install MySQL Server Standalone

1. **Download MySQL:**
   - Visit: https://dev.mysql.com/downloads/installer/
   - Download MySQL Installer for Windows

2. **Install MySQL:**
   - Run installer as Administrator
   - Choose "Server only" or "Custom" installation
   - Set root password during installation
   - Start MySQL service

3. **Create OpenEMR User:**
   ```cmd
   mysql -u root -p
   ```
   ```sql
   CREATE DATABASE openemr;
   CREATE USER 'admin'@'localhost' IDENTIFIED BY 'Badger1234!';
   GRANT ALL PRIVILEGES ON openemr.* TO 'admin'@'localhost';
   FLUSH PRIVILEGES;
   EXIT;
   ```

### Option 3: Install MariaDB

1. **Download MariaDB:**
   - Visit: https://mariadb.org/download/
   - Download MariaDB Server for Windows

2. **Install MariaDB:**
   - Run installer as Administrator
   - Set root password during installation
   - Start MariaDB service

3. **Create OpenEMR User:**
   ```cmd
   mysql -u root -p
   ```
   ```sql
   CREATE DATABASE openemr;
   CREATE USER 'admin'@'localhost' IDENTIFIED BY 'Badger1234!';
   GRANT ALL PRIVILEGES ON openemr.* TO 'admin'@'localhost';
   FLUSH PRIVILEGES;
   EXIT;
   ```

## After Installing Database Server

1. **Verify MySQL is Running:**
   ```powershell
   Get-Service -Name "*mysql*"
   # OR
   netstat -an | findstr :3306
   ```

2. **Test Connection:**
   ```cmd
   php test_db_connection.php
   ```

3. **Access OpenEMR:**
   - Navigate to your OpenEMR installation
   - Run the setup wizard if this is a fresh installation
   - Or access the login page if already configured

## Quick Test Commands

After installing MySQL/MariaDB, verify with:

```cmd
# Test database connection manually
mysql -h localhost -P 3306 -u admin -p

# Test PHP connection
php test_db_connection.php

# Check if MySQL service is running
sc query mysql
```

## Common Issues and Solutions

### Issue: "Access denied for user"
**Solution:** User doesn't exist or wrong password
```sql
DROP USER 'admin'@'localhost';
CREATE USER 'admin'@'localhost' IDENTIFIED BY 'Badger1234!';
GRANT ALL PRIVILEGES ON openemr.* TO 'admin'@'localhost';
FLUSH PRIVILEGES;
```

### Issue: "Unknown database 'openemr'"
**Solution:** Database doesn't exist
```sql
CREATE DATABASE openemr;
```

### Issue: "Can't connect to MySQL server"
**Solution:** MySQL service not running
```cmd
net start mysql
# OR for XAMPP
# Start MySQL from XAMPP Control Panel
```

## Next Steps

1. **Choose Installation Method:** Select XAMPP (easiest) or standalone MySQL
2. **Install Database Server:** Follow the appropriate installation steps above
3. **Create Database and User:** Use the provided SQL commands
4. **Test Connection:** Run `php test_db_connection.php` again
5. **Configure OpenEMR:** Access the OpenEMR setup if needed

## Files Modified
- ✅ `sites/default/sqlconf.php` - Database credentials updated
- ✅ `C:\tools\php82\php.ini` - PHP extensions enabled
- ✅ Test scripts created for troubleshooting

---

*Generated by GitHub Copilot - OpenEMR Database Setup Guide*